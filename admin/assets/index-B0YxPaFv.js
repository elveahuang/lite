var q=Object.defineProperty,B=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var D=(e,o,t)=>o in e?q(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,i=(e,o)=>{for(var t in o||(o={}))V.call(o,t)&&D(e,t,o[t]);if(w)for(var t of w(o))H.call(o,t)&&D(e,t,o[t]);return e},A=(e,o)=>B(e,N(o));var h=(e,o,t)=>new Promise((g,y)=>{var F=l=>{try{d(t.next(l))}catch(u){y(u)}},m=l=>{try{d(t.throw(l))}catch(u){y(u)}},d=l=>l.done?g(l.value):Promise.resolve(l.value).then(F,m);d((t=t.apply(e,o)).next())});import{ah as j,X as K,j as n,ai as I,a3 as r,a2 as T,r as p,aj as X,ak as G,al as J,am as Q,a1 as U}from"./index-Cy-1vFHR.js";import{aO as W}from"./XPlayer-B299lLD4.js";import{P as Y,u as Z,a as $,M as ee,b as ne,s as te}from"./data-table-CtFWOTMW.js";import{F as b}from"./index-DPVJNtMU.js";const oe=e=>j("/api/admin/announcement/list",e),ae=e=>j("/api/admin/announcement/details",e),se=e=>j("/api/admin/announcement/save",e),le=e=>j("/api/admin/announcement/delete",e),O={id:0,title:"",content:"",description:"",status:0,startDatetime:"",endDatetime:""},ue=()=>{const{t:e}=K(),{initialize:o,handleResult:t,handleParams:g}=ne(),F={columns:[{key:"title",dataIndex:"title",title:e("common:field_title")},{key:"operations",dataIndex:"id",title:e("common:label_action"),width:"200px",render:(a,s,x)=>n.jsxs(I,{children:[n.jsx(r,{size:"small",icon:n.jsx(T,{icon:"mdi:eye-outline"}),onClick:()=>{C(s.id).then()}}),n.jsx(r,{size:"small",icon:n.jsx(T,{icon:"ant-design:edit-outlined"}),onClick:()=>{C(s.id).then()}}),n.jsx(Y,{title:e("common:label_confirm_delete_record"),description:e("common:label_confirm_delete_record"),onConfirm:()=>{E(s.id).then()},onCancel:()=>{},children:n.jsx(r,{size:"small",danger:!0,icon:n.jsx(T,{icon:"ant-design:close-outlined"})})})]})}]},[m,d]=p.useState(o(F)),[l,{toggle:u}]=Z(!1),_=p.useRef(),R=()=>h(void 0,null,function*(){te(m,!0),yield oe(g(m)).then(a=>{d(t(m,a))})}),E=(a=0)=>h(void 0,null,function*(){console.log(a);const s=a?[a]:_.current.getSelectedRowKeys();if(console.log(s),X(s)){G(e("common:label_please_select_one_record")).then();return}le({ids:s}).then(x=>{x.code=="200"&&_.current.refresh()})}),[v,f]=p.useState(!1),[P,M]=p.useState(""),[c,k]=p.useState({}),[S]=b.useForm(),C=(a=0)=>h(void 0,null,function*(){a&&a>0?(M(e("common:announcement_pages_edit_title")),yield ae({id:a}).then(s=>{console.log(s.data),Object.assign(c,i({},s.data)),console.log(c),k(x=>i(i({},x),s.data))}),f(!0)):(M(e("common:announcement_pages_add_title")),Object.assign(c,i({},O)),k(i(i({},c),O)),f(!0))}),z=()=>{f(!1)},L=a=>h(void 0,null,function*(){console.log("handleFormSubmit..."),console.log(a),se(c).then(s=>{s.code=="200"&&(f(!1),_.current.refresh())})});return n.jsxs(n.Fragment,{children:[n.jsx($,{}),n.jsx("div",{className:"py-4",children:n.jsxs(I,{children:[n.jsx(r,{onClick:()=>{C(0).then()},children:e("common:button_add")}),n.jsx(r,{onClick:u,children:e(l?"common:label_batch_operation_cancel":"common:label_batch_operation")}),n.jsx(r,{onClick:()=>{E().then()},children:e("common:button_delete")})]})}),n.jsx(J,{ref:_,model:m,getDataList:R,rowSelectionEnabled:l,rowSelectionMultipleEnabled:l}),n.jsx(ee,{open:v,title:P,width:980,onOk:()=>{S.submit()},onCancel:()=>{z()},children:n.jsxs(b,A(i({},Q),{form:S,className:"entity-form",initialValues:c,onFinish:L,onFinishFailed:()=>{},children:[n.jsx(b.Item,{name:"title",label:e("common:field_title"),rules:[{required:!0,message:e("common:field_title_validation")}],children:n.jsx(U,{placeholder:e("common:field_title_placeholder")})}),n.jsx(b.Item,{name:"content",label:e("common:field_content"),rules:[{required:!0,message:e("common:field_content_validation")}],children:n.jsx(W,{content:c.content,onChange:a=>{S.setFieldValue("content",a)}})})]}))})]})};export{ue as default};
