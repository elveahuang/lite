var W=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var L=(e,t,n)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,c=(e,t)=>{for(var n in t||(t={}))v.call(t,n)&&L(e,n,t[n]);if(A)for(var n of A(t))ee.call(t,n)&&L(e,n,t[n]);return e},d=(e,t)=>Y(e,Z(t));var l=(e,t,n)=>new Promise((b,k)=>{var F=r=>{try{h(n.next(r))}catch(f){k(f)}},i=r=>{try{h(n.throw(r))}catch(f){k(f)}},h=r=>r.done?b(r.value):Promise.resolve(r.value).then(F,i);h((n=n.apply(e,t)).next())});import{ah as p,X as se,j as s,ai as V,a3 as u,a2 as C,r as m,aj as te,ak as ne,al as ae,am as oe,aJ as w,a1 as M,aK as O}from"./index-Cy-1vFHR.js";import{P as re,u as le,a as ie,M as q,b as ce,s as me}from"./data-table-CtFWOTMW.js";import{F as _}from"./index-DPVJNtMU.js";const de=e=>p("/api/admin/user/list",e),U=e=>p("/api/admin/user/details",e),ue=e=>p("/api/admin/user/save",e),_e=e=>p("/api/admin/user/delete",e),he=e=>p("/api/user/check/username",e),fe=e=>!!e&&e.constructor===Symbol,pe=e=>!!(e&&e.constructor&&e.call&&e.apply),be=e=>S(e)&&e%1===0,S=e=>{try{return Number(e)===e}catch(t){return!1}},je=e=>Object.prototype.toString.call(e)==="[object Date]",xe=e=>{if(e===!0||e===!1||e==null)return!0;if(S(e))return e===0;if(je(e))return isNaN(e.getTime());if(pe(e)||fe(e))return!1;const t=e.length;if(S(t))return t===0;const n=e.size;return S(n)?n===0:Object.keys(e).length===0},ye=(b,k,...F)=>l(void 0,[b,k,...F],function*(e,t,n={}){if(!xe(t)){const i=yield he({username:t,id:n.id||0});if(i.code===200&&i.data===!0)return Promise.resolve()}return Promise.reject(new Error(e.message))}),Fe=()=>{const{t:e}=se(),{initialize:t,handleResult:n,handleParams:b}=ce(),F={columns:[{key:"username",dataIndex:"username",title:e("common:user_field_username")},{key:"operations",dataIndex:"id",title:e("common:label_action"),width:"200px",render:(a,o,g)=>s.jsxs(V,{children:[s.jsx(u,{size:"small",icon:s.jsx(C,{icon:"mdi:eye-outline"}),onClick:()=>{alert(o.id),Q(o.id).then()}}),s.jsx(u,{size:"small",icon:s.jsx(C,{icon:"ant-design:edit-outlined"}),onClick:()=>{N(o.id).then()}}),s.jsx(re,{title:e("common:label_confirm_delete_record"),description:e("common:label_confirm_delete_record"),onConfirm:()=>{I(o.id).then()},onCancel:()=>{},children:s.jsx(u,{size:"small",danger:!0,icon:s.jsx(C,{icon:"ant-design:close-outlined"})})})]})}]},[i,h]=m.useState(t(F)),[r,{toggle:f}]=le(!1),j=m.useRef(),B=()=>l(void 0,null,function*(){me(i,!0),yield de(b(i)).then(a=>{h(n(i,a))})}),I=(a=0)=>l(void 0,null,function*(){console.log(a),console.log(be(a));const o=a?[a]:j.current.getSelectedRowKeys();if(console.log(o),te(o)){ne(e("common:label_please_select_one_record")).then();return}_e({ids:o}).then(g=>{g.code=="200"&&j.current.refresh()})}),[K,x]=m.useState(!1),[G,E]=m.useState(""),[y,P]=m.useState({}),[D]=_.useForm(),N=(a=0)=>l(void 0,null,function*(){a&&a>0?(E(e("common:user_pages_edit_title")),yield U({id:a}).then(o=>{P(Object.assign(y,c({},o.data)))}),x(!0)):(E(e("common:user_pages_add_title")),P(Object.assign(y,{status:0})),x(!0))}),H=()=>l(void 0,null,function*(){D.validateFields().then(a=>l(void 0,null,function*(){yield ue(a).then(o=>{o.code=="200"&&(x(!1),j.current.refresh())})}))}),J=()=>l(void 0,null,function*(){x(!1)}),[X,T]=m.useState(!1),[z,$]=m.useState({}),Q=(a=0)=>l(void 0,null,function*(){a&&a>0&&(yield U({id:a}).then(o=>{$(Object.assign(z,c({},o.data)))}),T(!0))}),R=()=>{T(!1)};return s.jsxs(s.Fragment,{children:[s.jsx(ie,{}),s.jsx("div",{className:"py-4",children:s.jsxs(V,{children:[s.jsx(u,{onClick:()=>{N(0).then()},children:e("common:button_add")}),s.jsx(u,{onClick:f,children:e(r?"common:label_batch_operation_cancel":"common:label_batch_operation")}),s.jsx(u,{onClick:()=>{I().then()},children:e("common:button_delete")})]})}),s.jsx(ae,{ref:j,model:i,getDataList:B,rowSelectionEnabled:r,rowSelectionMultipleEnabled:r}),s.jsx(q,{open:X,title:e("common:user_field_username"),width:980,onOk:()=>{R()},onCancel:()=>{R()},children:z.username}),s.jsx(q,{open:K,title:G,width:980,onOk:()=>{H().then()},onCancel:()=>{J().then()},children:s.jsxs(_,d(c({},oe),{form:D,className:"entity-form",initialValues:y,children:[s.jsx(_.Item,d(c({},w),{name:"username",label:e("common:user_field_username"),rules:[{required:!0,message:e("common:user_field_username_validation")},({getFieldValue:a})=>({message:e("common:user_field_username_validation_check"),validator:(o,g)=>l(void 0,null,function*(){return ye(o,g,a("id"))})})],children:s.jsx(M,{placeholder:e("common:user_field_username_placeholder")})})),s.jsx(_.Item,d(c({},w),{name:"displayName",label:e("common:user_field_display_name"),rules:[{required:!0,message:e("common:user_field_display_name_validation")}],children:s.jsx(M,{placeholder:e("common:user_field_display_name_placeholder")})})),s.jsx(_.Item,d(c({},w),{name:"password",label:e("common:user_field_password"),rules:[{required:!0,message:e("common:user_field_password_validation")}],children:s.jsx(M.Password,{placeholder:e("common:user_field_password_placeholder")})})),s.jsx(_.Item,d(c({},w),{name:"status",label:e("common:field_status"),rules:[{required:!0,message:e("common:user_field_password_validation")}],children:s.jsxs(O.Group,{value:y.status,children:[s.jsx(O,{value:1,children:e("common:label_status_on")}),s.jsx(O,{value:0,children:e("common:label_status_off")})]})}))]}))})]})};export{Fe as default};
