var Q=Object.defineProperty,W=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var T=(e,t,n)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,j=(e,t)=>{for(var n in t||(t={}))Y.call(t,n)&&T(e,n,t[n]);if(N)for(var n of N(t))Z.call(t,n)&&T(e,n,t[n]);return e},z=(e,t)=>W(e,X(t));var l=(e,t,n)=>new Promise((p,g)=>{var w=r=>{try{d(n.next(r))}catch(u){g(u)}},i=r=>{try{d(n.throw(r))}catch(u){g(u)}},d=r=>r.done?p(r.value):Promise.resolve(r.value).then(w,i);d((n=n.apply(e,t)).next())});import{ao as _,U as v,j as s,au as A,a1 as m,a0 as S,r as c,av as ee,aw as se,ax as te,ay as ne,$ as k}from"./index-DiKhK1Am.js";import{P as oe,u as ae,a as re,M as R,b as le,s as ie}from"./data-table-j_hWa2rf.js";import{F as h}from"./index-BGjFi4XB.js";const ce=e=>_("/api/admin/user/list",e),V=e=>_("/api/admin/user/details",e),me=e=>_("/api/admin/user/save",e),de=e=>_("/api/admin/user/delete",e),ue=e=>_("/api/user/check/username",e),he=e=>!!e&&e.constructor===Symbol,_e=e=>!!(e&&e.constructor&&e.call&&e.apply),pe=e=>y(e)&&e%1===0,y=e=>{try{return Number(e)===e}catch(t){return!1}},fe=e=>Object.prototype.toString.call(e)==="[object Date]",be=e=>{if(e===!0||e===!1||e==null)return!0;if(y(e))return e===0;if(fe(e))return isNaN(e.getTime());if(_e(e)||he(e))return!1;const t=e.length;if(y(t))return t===0;const n=e.size;return y(n)?n===0:Object.keys(e).length===0},xe=(p,g,...w)=>l(void 0,[p,g,...w],function*(e,t,n={}){if(!be(t)){const i=yield ue({username:t,id:n.id||0});if(i.code===200&&i.data===!0)return Promise.resolve()}return Promise.reject(new Error(e.message))}),Se=()=>{const{t:e}=v(),{initialize:t,handleResult:n,handleParams:p}=le(),w={columns:[{key:"username",dataIndex:"username",title:e("common:user_field_username")},{key:"operations",dataIndex:"id",title:e("common:label_action"),width:"200px",render:(o,a,x)=>s.jsxs(A,{children:[s.jsx(m,{size:"small",icon:s.jsx(S,{icon:"mdi:eye-outline"}),onClick:()=>{alert(a.id),J(a.id).then()}}),s.jsx(m,{size:"small",icon:s.jsx(S,{icon:"ant-design:edit-outlined"}),onClick:()=>{I(a.id).then()}}),s.jsx(oe,{title:e("common:label_confirm_delete_record"),description:e("common:label_confirm_delete_record"),onConfirm:()=>{C(a.id).then()},onCancel:()=>{},children:s.jsx(m,{size:"small",danger:!0,icon:s.jsx(S,{icon:"ant-design:close-outlined"})})})]})}]},[i,d]=c.useState(t(w)),[r,{toggle:u}]=ae(!1),f=c.useRef(),L=()=>l(void 0,null,function*(){ie(i,!0),yield ce(p(i)).then(o=>{d(n(i,o))})}),C=(o=0)=>l(void 0,null,function*(){console.log(o),console.log(pe(o));const a=o?[o]:f.current.getSelectedRowKeys();if(console.log(a),ee(a)){se(e("common:label_please_select_one_record")).then();return}de({ids:a}).then(x=>{x.code=="200"&&f.current.refresh()})}),[U,b]=c.useState(!1),[q,F]=c.useState(""),[M,B]=c.useState({}),[O]=h.useForm(),I=(o=0)=>l(void 0,null,function*(){o&&o>0?(F(e("common:user_pages_edit_title")),yield V({id:o}).then(a=>{B(Object.assign(M,j({},a.data)))}),b(!0)):(F(e("common:user_pages_add_title")),b(!0))}),$=()=>l(void 0,null,function*(){O.validateFields().then(o=>l(void 0,null,function*(){yield me(o).then(a=>{a.code=="200"&&(b(!1),f.current.refresh())})}))}),H=()=>l(void 0,null,function*(){b(!1)}),[K,E]=c.useState(!1),[P,G]=c.useState({}),J=(o=0)=>l(void 0,null,function*(){o&&o>0&&(yield V({id:o}).then(a=>{G(Object.assign(P,j({},a.data)))}),E(!0))}),D=()=>{E(!1)};return s.jsxs(s.Fragment,{children:[s.jsx(re,{}),s.jsx("div",{className:"py-4",children:s.jsxs(A,{children:[s.jsx(m,{onClick:()=>{I(0).then()},children:e("common:button_add")}),s.jsx(m,{onClick:u,children:e(r?"common:label_batch_operation_cancel":"common:label_batch_operation")}),s.jsx(m,{onClick:()=>{C().then()},children:e("common:button_delete")})]})}),s.jsx(te,{ref:f,model:i,getDataList:L,rowSelectionEnabled:r,rowSelectionMultipleEnabled:r}),s.jsx(R,{open:K,title:e("common:user_field_username"),width:980,onOk:()=>{D()},onCancel:()=>{D()},children:P.username}),s.jsx(R,{open:U,title:q,width:980,onOk:()=>{$().then()},onCancel:()=>{H().then()},children:s.jsxs(h,z(j({},ne),{form:O,className:"entity-form",initialValues:M,children:[s.jsx(h.Item,{name:"username",label:e("common:user_field_username"),rules:[{required:!0,message:e("common:user_field_username_validation")},({getFieldValue:o})=>({message:e("common:user_field_username_validation_check"),validator:(a,x)=>l(void 0,null,function*(){return xe(a,x,o("id"))})})],children:s.jsx(k,{placeholder:e("common:user_field_username_placeholder")})}),s.jsx(h.Item,{name:"displayName",label:e("common:user_field_display_name"),rules:[{required:!0,message:e("common:user_field_display_name_validation")}],children:s.jsx(k,{placeholder:e("common:user_field_display_name_placeholder")})}),s.jsx(h.Item,{name:"password",label:e("common:user_field_password"),rules:[{required:!0,message:e("common:user_field_password_validation")}],children:s.jsx(k.Password,{placeholder:e("common:user_field_password_placeholder")})})]}))})]})};export{Se as default};
